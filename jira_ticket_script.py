import requests
import json


# Jira API credentials and configuration

JIRA_URL = 'https://mycompany.atlassian.net'
API_ENDPOINT = f'{JIRA_URL}/rest/api/2/issue'
USER = 'my-email@example.com'
TOKEN = 'my-api-token'

# Load openvas scan report (example jso file path)
with open('/path/to/openvas_report.json') as f:
    report_data = json.load(f)

for vulnerability in report_data['severity'] == 'critical':
    payload = {
            "field": {
                "project": {"key": "SEC"},
                "summary": f"critical vulnerability: {vulnerability['title']}",
                "descritpion": vulnerability['description'],
                "issuetype": {"name":"Bug"},
                "priority": {"name": "critical"}
        }
    }
    response = requests.post(API_ENDPOINT, auth=(USER, TOKEN), json=payload)
    if response.status_code == 201:
        print("ticket created successfully.")
    else:
        print("failed to create ticket:, response.text)




